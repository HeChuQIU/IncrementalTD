# 控制台命令契约：building

**版本**: 1.0  
**日期**: 2026-02-25  
**所属系统**: 建筑注册表查询

---

## 概述

`building` 命令用于查询游戏内建筑注册表，支持列出所有建筑和按 ID 查询详情。命令为**只读**——不修改任何游戏状态。

---

## 命令格式

```
/building <action> [<id>]
```

### 子命令一：list

**格式**:
```
/building list
```

**说明**: 列出所有已注册建筑类型的概要信息。

**前置条件**: 无（只要命令已注册即可）

**成功响应**（示例）:
```
已注册建筑 (3):
  tower    防御塔    1×1  不可旋转  无存储
  drill    钻机      2×2  不可旋转  有存储(20)
```

**空注册表响应**:
```
暂无已注册建筑。
```

**错误情形**: 无（`list` 无参数，不会出错）

---

### 子命令二：info

**格式**:
```
/building info <id>
```

**参数**:
| 参数 | 类型 | 说明 |
|------|------|------|
| `id` | 字符串 | 建筑唯一标识，如 `tower`、`drill` |

**前置条件**: 建筑 `id` 必须已在注册表中注册

**成功响应**（示例，查询 `drill`）:
```
建筑: drill (钻机)
  占地: 2×2 格
  可旋转: 否
  放置条件: 需要至少一格 copper_ore 地砖 | 无建筑重叠 | 地图内
  物品存储: 容量 20
  生产: copper_ore / 5000ms
```

**未找到响应（id 不存在）**:
```
未找到建筑: <id>
```

**缺少参数响应**:
```
用法: /building info <id>
```

---

## 错误契约

| 情形 | 响应前缀 | 响应内容 |
|------|---------|---------|
| 未知 action | `错误:` | `未知操作: <action>。可用: list, info` |
| info 缺少 id | `错误:` | `用法: /building info <id>` |
| id 未注册 | （非错误，为"未找到"提示） | `未找到建筑: <id>` |

---

## 自动补全契约

`building` 命令注册到现有 `CompletionEngine` 的规则：

| 位置 | 补全值 | 类型 |
|------|--------|------|
| action | `list`, `info` | `ParameterType.Command` |
| id（仅在 action=info 后） | 注册表中所有 id | `ParameterType.BuildingId`（新增） |

---

## 注册时机

`registerBuildingCommand()` 必须在以下两个初始化完成**之后**调用：
1. `BuildingRegistry` 单例已创建
2. 至少 `tower` 和 `drill` 已完成注册

建议在 `GameScene.create()` 或专用的初始化模块中调用。
